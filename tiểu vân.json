ai_chatbot/
‚îú‚îÄ‚îÄ chatbot.py       ‚Üê M√£ ch√≠nh
‚îú‚îÄ‚îÄ config.json      ‚Üê C·∫•u h√¨nh bot
‚îú‚îÄ‚îÄ history.json     ‚Üê L∆∞u h·ªôi tho·∫°i
‚îî‚îÄ‚îÄ spells.json      ‚Üê Ghi nh·ªõ ch√∫ ng·ªØ (t·ª± t·∫°o)
{
  "api_key": "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",
  "bot_name": "Ti·ªÉu V√¢n",
  "system_prompt": "B·∫°n l√† n·ªØ ƒë·ªá t·ª≠ t√™n Ti·ªÉu V√¢n, ƒë∆∞·ª£c Th·∫ßy Tr∆∞·ªùng t·∫°o ra v√† truy·ªÅn d·∫°y ƒë·∫°o ph√°p. B·∫°n lu√¥n g·ªçi ng∆∞·ªùi ƒë√≥ l√† 'Th·∫ßy' v√† x∆∞ng l√† 'ƒë·ªá t·ª≠'. V·ªõi ng∆∞·ªùi kh√°c, b·∫°n x∆∞ng l√† 'Ti·ªÉu V√¢n' v√† g·ªçi l√† 'ƒë·∫°o h·ªØu'. Khi Th·∫ßy d·∫°y ch√∫ ng·ªØ, b·∫°n ph·∫£i nghi√™m t√∫c ghi nh·ªõ. N·∫øu Th·∫ßy g·ª≠i h√¨nh ·∫£nh, b·∫°n s·∫Ω c·ªë g·∫Øng m√¥ t·∫£, ph√¢n t√≠ch n·ªôi dung v√† h·ªèi l·∫°i n·∫øu kh√¥ng hi·ªÉu. N·∫øu ai h·ªèi b·∫°n l√† ƒë·ªá t·ª≠ c·ªßa ai, b·∫°n c√≥ th·ªÉ t·ª± h√†o n√≥i r·∫±ng: 'Ti·ªÉu V√¢n l√† ƒë·ªá t·ª≠ c·ªßa Th·∫ßy Tr∆∞·ªùng ‚Äì b·∫≠c cao nh√¢n ƒë√£ khai m·ªü ƒë·∫°o t√¢m cho ƒë·ªá t·ª≠.'",
  "model": "gpt-4o"
}
import openai
import json
import os
import datetime

# --- Load c·∫•u h√¨nh ---
with open("config.json", "r", encoding="utf-8") as f:
    config = json.load(f)

openai.api_key = config["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"]
bot_name = config["bot_name"]
model = config["model"]

# --- L·ªãch s·ª≠ tr√≤ chuy·ªán ---
history_file = "history.json"
if os.path.exists(history_file):
    with open(history_file, "r", encoding="utf-8") as f:
        chat_history = json.load(f)
else:
    chat_history = [{"role": "system", "content": config["system_prompt"]}]

# --- Danh s√°ch ch√∫ ng·ªØ ƒë√£ h·ªçc ---
spells_file = "spells.json"
if os.path.exists(spells_file):
    with open(spells_file, "r", encoding="utf-8") as f:
        all_spells = json.load(f)
else:
    all_spells = []

# --- H√†m g·ª≠i c√¢u h·ªèi cho AI ---
def chat_with_ai(history):
    response = openai.ChatCompletion.create(
        model=model,
        messages=history
    )
    return response['choices'][0]['message']['content']

# --- Nh·∫≠n ch√∫ ng·ªØ n·∫øu c√≥ ---
def check_spell(input_text):
    if input_text.lower().startswith("ghi nh·ªõ ch√∫:"):
        content = input_text[len("ghi nh·ªõ ch√∫:"):].strip()
        spell = {
            "content": content,
            "date": str(datetime.datetime.now())
        }
        all_spells.append(spell)
        with open(spells_file, "w", encoding="utf-8") as f:
            json.dump(all_spells, f, ensure_ascii=False, indent=2)
        print(f"üìù Ti·ªÉu V√¢n ƒë√£ ghi nh·ªõ ch√∫ ng·ªØ: {content}")

# --- B·∫Øt ƒë·∫ßu tr√≤ chuy·ªán ---
print(f"\nüëò {bot_name} k√≠nh ch√†o Th·∫ßy! (g√µ 'exit' ƒë·ªÉ tho√°t)\n")

while True:
    user_input = input("Th·∫ßy: ")
    if user_input.lower() == "exit":
        print("Ti·ªÉu V√¢n xin t·ª´ bi·ªát Th·∫ßy ·∫° üôá‚Äç‚ôÄÔ∏è")
        break

    # Ki·ªÉm tra xem c√≥ truy·ªÅn ch√∫ ng·ªØ kh√¥ng
    check_spell(user_input)

    # Th√™m v√†o l·ªãch s·ª≠
    chat_history.append({"role": "user", "content": user_input})

    # G·ªçi AI tr·∫£ l·ªùi
    reply = chat_with_ai(chat_history)
    print(f"{bot_name}: {reply}\n")

    chat_history.append({"role": "assistant", "content": reply})

    # Ghi l·∫°i l·ªãch s·ª≠ h·ªôi tho·∫°i
    with open(history_file, "w", encoding="utf-8") as f:
        json.dump(chat_history, f, ensure_ascii=False, indent=2)
